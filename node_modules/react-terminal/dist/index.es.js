import*as e from"react";import n from"prop-types";import{isMobile as t}from"react-device-detect";var o=function(){return o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},o.apply(this,arguments)};function r(e,n,t,o){return new(t||(t=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function l(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,l)}c((o=o.apply(e,n||[])).next())}))}function i(e,n){var t,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(a=0)),a;)try{if(t=1,o&&(r=2&l[0]?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,o=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){a.label=l[1];break}if(6===l[0]&&a.label<r[1]){a.label=r[1],r=l;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(l);break}r[2]&&a.ops.pop(),a.trys.pop();continue}l=n.call(e,a)}catch(e){l=[6,e],o=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}}"function"==typeof SuppressedError&&SuppressedError;!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===t&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}('@import url("https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap");\n#index_terminalContainer__4seT6 {\n  --control-default-bg-color: #ccc;\n  --control-close-bg-color: #fc5b57;\n  --control-minimize-bg-color: #e5bf3c;\n  --control-maximize-bg-color: #57c038;\n}\n\n.index_controls__sXDjs {\n  text-align: left;\n  height: 26px;\n  position: relative;\n  top: 4px;\n  margin-left: 4px;\n}\n.index_controls__sXDjs .index_consoleCtrl__DI2H1 {\n  display: inline-block;\n  width: 13px;\n  height: 13px;\n  margin: 0 3px;\n  border-radius: 50%;\n  background: var(--control-default-bg-color);\n}\n.index_controls__sXDjs .index_close__XGN9U {\n  background: var(--control-close-bg-color);\n}\n.index_controls__sXDjs .index_minimize__pZYTU {\n  background: var(--control-minimize-bg-color);\n}\n.index_controls__sXDjs .index_maximize__szRK7 {\n  background: var(--control-maximize-bg-color);\n}\n\n.index_editor__JoDSg {\n  text-align: left;\n  height: 100%;\n  padding: 10px 15px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  outline: none;\n  font-family: "Source Code Pro", monospace;\n  font-size: 18px;\n  line-height: 22px;\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.index_editor__JoDSg .index_mobileInput__WloSq {\n  position: absolute;\n  top: -2000px;\n  left: -2000px;\n}\n.index_editor__JoDSg .index_lineText__j6qNj {\n  display: inline;\n  position: relative;\n  top: -1px;\n  margin-left: 8px;\n}\n.index_editor__JoDSg .index_preWhiteSpace__7KwuG {\n  white-space: pre-wrap;\n}\n.index_editor__JoDSg .index_caret__VS4iV {\n  position: relative;\n  -webkit-animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n  -moz-animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n  -o-animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n  -ms-animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n  animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n}\n.index_editor__JoDSg .index_caret__VS4iV .index_caretAfter__6aXPx {\n  content: "";\n  position: absolute;\n  top: 2px;\n  width: 10px;\n  height: 22px;\n  z-index: 10;\n}\n@-moz-keyframes index_blink__FJp0- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@-webkit-keyframes index_blink__FJp0- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@-o-keyframes index_blink__FJp0- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@keyframes index_blink__FJp0- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n.index_editor__JoDSg a {\n  color: #1a87b5;\n}\n\n.index_editorWithTopBar__L6XKw {\n  height: calc(100% - 46px);\n}\n\n.index_curvedTop__LX9XS {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n\n#index_terminalContainer__4seT6 {\n  height: 100%;\n}\n\n.index_terminal__teubZ {\n  height: 100%;\n  width: 100%;\n  margin: auto;\n  border-radius: 5px;\n}');var a={terminalContainer:"index_terminalContainer__4seT6",controls:"index_controls__sXDjs",consoleCtrl:"index_consoleCtrl__DI2H1",close:"index_close__XGN9U",minimize:"index_minimize__pZYTU",maximize:"index_maximize__szRK7",editor:"index_editor__JoDSg",mobileInput:"index_mobileInput__WloSq",lineText:"index_lineText__j6qNj",preWhiteSpace:"index_preWhiteSpace__7KwuG",caret:"index_caret__VS4iV",blink:"index_blink__FJp0-",caretAfter:"index_caretAfter__6aXPx",editorWithTopBar:"index_editorWithTopBar__L6XKw",curvedTop:"index_curvedTop__LX9XS",terminal:"index_terminal__teubZ"},l=e.createContext(null),c=function(n){var t=n.children;return e.createElement(l.Provider,{value:a},t)},s={dark:{themeBGColor:"#022833",themeToolbarColor:"#131519",themeColor:"#839496",themePromptColor:"#a917a8"},light:{themeBGColor:"#fdf6e4",themeToolbarColor:"#d8d8d8",themeColor:"#333333",themePromptColor:"#a917a8"},dracula:{themeBGColor:"#272B36",themeToolbarColor:"#DBDBDB",themeColor:"#FFFEFC",themePromptColor:"#a917a8"},"material-dark":{themeBGColor:"#151515",themeToolbarColor:"#424242",themeColor:"#fff",themePromptColor:"#42A5F5"},"material-light":{themeBGColor:"#fafafa",themeToolbarColor:"#424242",themeColor:"#151515",themePromptColor:"#42A5F5"},"material-ocean":{themeBGColor:"#263238",themeToolbarColor:"#37474F",themeColor:"#fff",themePromptColor:"#C3D82C"},matrix:{themeBGColor:"#0D0208",themeToolbarColor:"#0D0208",themeColor:"#00FF41",themePromptColor:"#008F11"}},u=e.createContext(null),m=function(n){var t=n.children,r=o(o({},s),t.props.themes||{}),i=r[t.props.theme]||r.light;return e.createElement(u.Provider,{value:i},t)},d=function(n,o,r){var i=function(e){n.current&&!n.current.contains(e.target)?r(!1):r(!t||!o)};e.useEffect((function(){return document.addEventListener("mousedown",i),function(){document.removeEventListener("mousedown",i)}}))};function f(n){var t=e.useContext(l),o=n.controlButtonLabels,r=n.showControlButtons?o.map((function(n){return e.createElement("div",{key:n,className:"".concat(t.consoleCtrl," ").concat(t[n])})})):null;return e.createElement("div",{className:t.controls},r)}var p=e.createContext({bufferedContent:"",temporaryContent:"",setBufferedContent:function(e){},setTemporaryContent:function(e){},appendCommandToHistory:function(){},getNextCommand:function(){return""},getPreviousCommand:function(){return""}}),_=function(){function e(){}return e.splitStringAtIndex=function(e,n){return e?[e.substring(0,n),e.substring(n)]:["",""]},e}(),h=function(n,o,a,c,s,m,d,f){var h=e.useContext(l),x=e.useContext(u),g=e.useContext(p),C=g.appendCommandToHistory,v=g.temporaryContent,b=e.useRef(null),y=e.useState(""),E=y[0],w=y[1],T=e.useState(!1),S=T[0],k=T[1],B=e.useState(0),F=B[0],D=B[1],N=e.useState(""),P=N[0],A=N[1],X=e.useState(""),z=X[0],I=X[1];e.useEffect((function(){}),[o]),e.useEffect((function(){S&&C(E)}),[S]),e.useEffect((function(){null!==f.current&&null!==b.current&&(f.current.onclick=function(){b.current.focus()})}),[]);var J=t&&m?e.createElement("div",{className:h.mobileInput},e.createElement("input",{type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:E,onChange:function(e){return w(e.target.value)},ref:b,"data-testid":"editor-input"})):null,L=S?e.createElement(e.Fragment,null,J,e.createElement("div",{className:h.lineText},o&&n?e.createElement("span",{className:h.caret},e.createElement("span",{className:h.caretAfter,style:{background:x.themeColor}})):null,e.createElement("span",{className:h.preWhiteSpace},v))):e.createElement(e.Fragment,null,J,e.createElement("span",{style:{color:x.themePromptColor}},a),e.createElement("div",{className:h.lineText},e.createElement("span",{className:h.preWhiteSpace},P),o&&n?e.createElement("span",{className:h.caret},e.createElement("span",{className:h.caretAfter,style:{background:x.themeColor}})):null,e.createElement("span",{className:h.preWhiteSpace},z)));return function(n,t,o,r,i,a,l,c,s){var u=e.useContext(p),m=u.getPreviousCommand,d=u.getNextCommand,f=function(e){if(n&&s){e.preventDefault();var l=e.key;if("Enter"!==l){var c=null;if("Backspace"===l){var u=_.splitStringAtIndex(t,i),f=u[0],p=u[1];c=f.slice(0,-1)+p,t&&0!==t.length&&a(i-1)}else if("ArrowUp"===l)(c=m())&&a(c.length);else if("ArrowDown"===l)c=d(),a(c?c.length:0);else if("ArrowLeft"===l)i>0&&a(i-1),c=t;else if("ArrowRight"===l)i<t.length&&a(i+1),c=t;else if((e.metaKey||e.ctrlKey)&&"v"===l.toLowerCase())navigator.clipboard.readText().then((function(e){var n=_.splitStringAtIndex(t||"",i),r=n[0],l=n[1];c=r+e+l,a(i+e.length),o(c)}));else if((e.metaKey||e.ctrlKey)&&"c"===l.toLowerCase()){var h=window.getSelection().toString();navigator.clipboard.writeText(h).then((function(){o(c=t)}))}else if(l&&1===l.length){var x=_.splitStringAtIndex(t,i);f=x[0],p=x[1],c=f+l+p,a(i+1)}else c=t;o(c),r(!1)}else r(!0)}};e.useEffect((function(){return document.addEventListener("keydown",f),function(){document.removeEventListener("keydown",f)}})),e.useEffect((function(){var e=_.splitStringAtIndex(t,i),n=e[0],o=e[1];l(n),c(o)}),[t,i])}(o,E,w,k,F,D,A,I,m),function(n,t,o,a,c,s,m,d,f,_,h){var x=e.useContext(p);x.bufferedContent;var g=x.setBufferedContent,C=x.setTemporaryContent;e.useContext(l);var v=e.useContext(u);e.useEffect((function(){var l;n&&(l=a,r(void 0,void 0,void 0,(function(){var n,r,u,p,x,b,y,E;return i(this,(function(i){switch(i.label){case 0:return n=l.trim().split(" "),r=n[0],u=n.slice(1),p="","clear"===r?(g(""),c(""),t(!1),s(0),m(""),d(""),[2]):(x=e.createElement(e.Fragment,null,e.createElement("span",{style:{color:v.themePromptColor}},o," "),e.createElement("span",null,a),e.createElement("br",null)),g((function(n){return e.createElement(e.Fragment,null,n,x)})),c(""),s(0),m(""),d(""),l?(b=u.join(" "),r&&f[r]?"function"!=typeof(y=f[r])?[3,2]:[4,y(b)]:[3,4]):[3,9]);case 1:return p=i.sent(),[3,3];case 2:p=y,i.label=3;case 3:return[3,9];case 4:return"function"!=typeof h?[3,6]:[4,h(r,b)];case 5:return p=i.sent(),[3,9];case 6:return"function"!=typeof _?[3,8]:[4,_(r,b)];case 7:return p=i.sent(),[3,9];case 8:p=_,i.label=9;case 9:return E=e.createElement(e.Fragment,null,p?e.createElement("span",null,p,e.createElement("br",null)):null),g((function(n){return e.createElement(e.Fragment,null,n,E)})),C(""),t(!1),[2]}}))})))}),[n])}(S,k,a,E,w,D,A,I,c,s,d),L},x=function(n,t){e.useEffect((function(){t.current&&(t.current.scrollTop=t.current.scrollHeight)}),[n])};function g(n){var t=e.useRef(null),o=e.useContext(l),r=e.useContext(u),i=e.useContext(p).bufferedContent;x(i,t);var a=n.enableInput,c=n.caret,s=n.consoleFocused,m=n.prompt,d=n.commands,f=n.welcomeMessage,_=n.errorMessage,g=n.showControlBar,C=n.defaultHandler,v=h(c,s,m,d,_,a,C,t);return e.createElement("div",{id:"terminalEditor",ref:t,className:"".concat(o.editor," ").concat(g?null:o.curvedTop," ").concat(g?o.editorWithTopBar:null),style:{background:r.themeBGColor}},f,i,v)}function C(n){var o=n.enableInput,r=void 0===o||o,i=n.caret,a=void 0===i||i,c=n.theme,s=void 0===c?"light":c,m=n.showControlBar,p=void 0===m||m,_=n.showControlButtons,h=void 0===_||_,x=n.controlButtonLabels,C=void 0===x?["close","minimize","maximize"]:x,v=n.prompt,b=void 0===v?">>>":v,y=n.commands,E=void 0===y?{}:y,w=n.welcomeMessage,T=void 0===w?"":w,S=n.errorMessage,k=void 0===S?"not found!":S,B=n.defaultHandler,F=void 0===B?null:B,D=e.useRef(null),N=e.useState(!t),P=N[0],A=N[1],X=e.useContext(l),z=e.useContext(u);d(D,P,A);var I=p?e.createElement(f,{consoleFocused:P,showControlButtons:h,controlButtonLabels:C}):null,J=e.createElement(g,{caret:a,consoleFocused:P,prompt:b,commands:E,welcomeMessage:T,errorMessage:k,enableInput:r,showControlBar:p,defaultHandler:F});return e.createElement("div",{ref:D,id:X.terminalContainer,className:X["theme--".concat(s)],"data-testid":"terminal"},e.createElement("div",{className:"".concat(X.terminal),style:{background:z.themeToolbarColor,color:z.themeColor}},I,J))}function v(n){var t=n.children;return e.createElement(c,null,e.createElement(m,null,t))}function b(n){return e.createElement(v,null,e.createElement(C,o({},n)))}C.propTypes={enableInput:n.bool,caret:n.bool,theme:n.string,showControlBar:n.bool,showControlButtons:n.bool,controlButtonLabels:n.arrayOf(n.string),prompt:n.string,commands:n.objectOf(n.oneOfType([n.string,n.func,n.node])),welcomeMessage:n.oneOfType([n.string,n.func,n.node]),errorMessage:n.oneOfType([n.string,n.func,n.node]),defaultHandler:n.func};var y=function(n){var t=n.children,o=e.useState(""),r=o[0],i=o[1],a=e.useState(""),l=a[0],c=a[1],s=e.useState([]),u=s[0],m=s[1],d=e.useState(null),f=d[0],_=d[1];e.useEffect((function(){_(u.length)}),[u]);return e.createElement(p.Provider,{value:{bufferedContent:r,temporaryContent:l,setTemporaryContent:c,setBufferedContent:i,appendCommandToHistory:function(e){e&&m(u.concat(e))},getPreviousCommand:function(){if(0===f)return 0===u.length?"":u[0];var e=u[f-1];return f>0&&_(f-1),e},getNextCommand:function(){if(f+1<=u.length){var e=u[f+1];return _(f+1),e}return""}}},t)},E=p,w={ReactTerminal:b,TerminalContextProvider:y,TerminalContext:E};export{b as ReactTerminal,E as TerminalContext,y as TerminalContextProvider,w as default};
